# デザインシステムガバナンス

デザインシステムの継続的な維持・改善のためのガバナンス設計。

## 目次

- [ガバナンスモデル](#ガバナンスモデル)
- [コントリビューションフロー](#コントリビューションフロー)
- [バージョニング](#バージョニング)
- [監査](#監査)
- [KPIと計測](#kpiと計測)
- [事例から学ぶガバナンス](#事例から学ぶガバナンス)

---

## ガバナンスモデル

### 3つのモデル

| モデル | 意思決定 | コントリビューション | 適する組織 |
|--------|---------|-------------------|-----------|
| 中央集権型 | 専任DSチーム | DSチームのみ | 小〜中規模、立ち上げ期 |
| フェデレーテッド型 | DSチーム + 各チーム代表 | 全チーム（ガイドライン内） | 中〜大規模 |
| コミュニティ駆動型 | コミュニティ投票 | 誰でも | 大規模・OSS |

### 選択基準

```
チーム数 ≤ 3 → 中央集権型（速度優先）
チーム数 4-10 → フェデレーテッド型（バランス）
チーム数 > 10 or OSS → コミュニティ駆動型（スケーラビリティ）
```

### フェデレーテッド型の構成（推奨）

```
DS Core Team（2-3名）
  ├── 方針・原則の策定
  ├── Foundation/Token管理
  ├── コントリビューションレビュー
  └── 品質基準の維持

DS Champions（各チーム1名）
  ├── チーム内でのDS推進
  ├── フィードバック・要望の集約
  └── コントリビューションの実施
```

---

## コントリビューションフロー

### 新規コンポーネント追加

```
1. 提案
   ├── ニーズの明文化（どの画面で何が不足しているか）
   ├── 既存コンポーネントで代替できないか確認
   └── RFC/Issueを作成

2. 設計
   ├── DDRで設計判断を記録
   ├── Doneness Matrixの各軸で仕様を定義
   └── デザインレビュー

3. 実装
   ├── コード実装 + ユニットテスト
   ├── Storybook/ドキュメント追加
   └── アクセシビリティテスト

4. レビュー
   ├── DS Core Teamによる品質チェック
   ├── 利用チームによるフィードバック
   └── 承認 or 修正要求

5. リリース
   ├── バージョン更新
   ├── 変更ログ記録
   └── 利用ガイドの通知
```

### 品質基準（GOV.UK参考）

コントリビューションの承認基準:

| 基準 | 説明 |
|------|------|
| 有用性 | 複数のチーム/画面で再利用される |
| 一貫性 | 既存のデザイン原則・パターンに沿っている |
| アクセシビリティ | WCAG 2.1 AA準拠 |
| テスト済み | ユニットテスト + Visual Regressionテスト通過 |
| ドキュメント | 使用ガイド、Props仕様、Do/Don'tが記述されている |

---

## バージョニング

### セマンティックバージョニング

```
MAJOR.MINOR.PATCH

MAJOR: 破壊的変更（トークン名変更、コンポーネントAPI変更）
MINOR: 後方互換の機能追加（新コンポーネント、新バリアント）
PATCH: バグ修正、ドキュメント更新
```

### 破壊的変更の管理

1. **事前通知**: RFCで変更を提案し、レビュー期間（最低3営業日）を設ける
2. **非推奨期間**: 旧APIを `@deprecated` で最低2スプリント維持
3. **移行ガイド**: Before/After の対応コードを提供
4. **codemods**: 自動移行スクリプトを可能な限り提供

### 変更ログ

```markdown
## [2.0.0] - YYYY-MM-DD

### Breaking Changes
- `color-primary` → `color-brand-primary` にリネーム
  - 移行: `npx ds-codemod rename-token color-primary color-brand-primary`

### Added
- `Badge` コンポーネント追加
- `color-surface-*` セマンティックトークン追加

### Fixed
- `Button` のフォーカスリングが3:1未満だった問題を修正
```

---

## 監査

### 定期監査（四半期推奨）

| チェック項目 | 手法 |
|-------------|------|
| トークン利用率 | コードベース検索で未使用トークンを検出 |
| コンポーネント採用率 | DS外コンポーネントの使用箇所を計測 |
| アクセシビリティ | axe-coreで全画面スキャン |
| Visual Regression | ベースラインとの差分検出 |
| ドキュメント鮮度 | 最終更新日から90日超のドキュメントをフラグ |

### 監査スコアリング

0-2スケールで各領域を評価:

| スコア | 意味 |
|--------|------|
| 0 | 未対応 or 重大な問題あり |
| 1 | 部分的に対応、改善が必要 |
| 2 | 十分に対応、基準を満たしている |

---

## KPIと計測

### コアKPI

| KPI | 計測方法 | 目標 |
|-----|---------|------|
| 採用率 | DSコンポーネント / 全コンポーネント | >80% |
| 一貫性違反 | DSから逸脱したUI要素数 | 月次減少 |
| 例外申請 | DS外コンポーネントの正式例外数 | <5件/月 |
| 修正リードタイム | バグ報告→修正マージの平均日数 | <5営業日 |
| コントリビューション | 外部チームからの貢献PR数 | 月次増加 |

### 計測の自動化

- CI/CDでコンポーネント利用率を自動集計
- Storybookのアクセスログでドキュメント参照頻度を追跡
- lint違反数の推移をダッシュボード化

---

## 事例から学ぶガバナンス

### GOV.UK Design System

- エビデンスベースのコントリビューション基準
- 「十分にテストされた」「複数サービスで有用」が承認条件
- 参考: https://design-system.service.gov.uk/community/contribution-criteria/

### Carbon Design System (IBM)

- オープンソースのフェデレーテッドモデル
- GitHub Issueベースの提案・議論プロセス
- コンポーネントだけでなくUIパターンレベルまでガバナンス対象

### Polaris (Shopify)

- ビジュアル事例中心のドキュメント
- 「何をすべきか」だけでなく「何をすべきでないか」（Don't）の明示
- 参考: https://polaris.shopify.com
