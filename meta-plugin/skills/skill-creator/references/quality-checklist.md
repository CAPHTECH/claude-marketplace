# Quality Checklist & Anti-Patterns

スキルの品質検証と、避けるべきパターン。

## Creation Checklist

### 構造

- [ ] SKILL.md が存在する
- [ ] YAML frontmatter に `name` と `description` がある
- [ ] `name` はディレクトリ名と一致している
- [ ] `name` は kebab-case（`[a-z0-9-]+`、64文字以内）
- [ ] `description` は単一行、1024文字以内
- [ ] `description` に XMLタグ (`<`, `>`) を含まない
- [ ] SKILL.md本体は500行以下
- [ ] 不要なファイル（README, CHANGELOG等）が存在しない

### description

- [ ] **何をするか** が明記されている
- [ ] **いつ使うか**（トリガー条件）が含まれている
- [ ] ユーザーが使うキーワードが含まれている
- [ ] 曖昧な表現がない

### コンテンツ

- [ ] Claudeが既に知っている情報を繰り返していない
- [ ] SKILL.mdとreferences/で情報が重複していない
- [ ] references/ は1階層のみ
- [ ] references/ の全ファイルがSKILL.mdからリンクされている
- [ ] references/ のリンクに「いつ読むべきか」の説明がある
- [ ] コード例が具体的で実際に動く
- [ ] スクリプトがテスト済み
- [ ] 命令形で記述されている

### Frontmatter（該当する場合）

- [ ] 副作用のある操作に `disable-model-invocation: true` が設定されている
- [ ] 背景知識スキルに `user-invocable: false` が設定されている
- [ ] `context: fork` は独立タスクにのみ使用されている
- [ ] `argument-hint` がユーザーに期待する引数を示している

## Anti-Patterns

### 1. コンテキスト肥大

| 問題 | 対策 |
|------|------|
| SKILL.md 500行超 | references/ に分割 |
| Claudeが既知の情報を説明 | 削除する |
| 複数ライブラリの選択肢を羅列 | 1つに絞るか判断基準を書く |
| 冗長な説明 | 簡潔な例に置き換える |

### 2. descriptionの問題

| 問題 | 対策 |
|------|------|
| YAMLマルチライン(`\|`, `>`) | 単一行に書き直す |
| トリガー条件が本体にしかない | descriptionに移動する |
| 曖昧すぎる（「ヘルパー」「ツール」） | 具体的な機能とトリガーを記述 |
| 1024文字超 | 要約して短縮 |

### 3. ファイル構成の問題

| 問題 | 対策 |
|------|------|
| references/ がネストしている | 1階層に平坦化 |
| SKILL.mdとreferences/で重複 | どちらか一方に集約 |
| Windows パス（`\`） | フォワードスラッシュ（`/`）に統一 |
| 不要ファイル（README等） | 削除する |
| references/ がSKILL.mdからリンクされていない | リンクと説明を追加 |

### 4. 設計の問題

| 問題 | 対策 |
|------|------|
| 時間依存の情報を含む | エバーグリーンな内容に書き直す |
| 用語が統一されていない | 1つの用語に統一する |
| マジックナンバー | 根拠を明記する |
| 副作用操作が自動起動可能 | `disable-model-invocation: true` を設定 |

## Evaluation-Driven Development

スキルを作る前に評価を設計する。

### プロセス

1. **ギャップ特定**: スキルなしで代表的タスクを実行し、Claudeが苦戦する箇所を記録
2. **テストシナリオ作成**: 少なくとも3つのシナリオを定義
3. **ベースライン計測**: スキルなしでの成功率・品質を記録
4. **最小実装**: ギャップを埋める最小限の指示を記述
5. **評価**: テストシナリオで効果を検証
6. **イテレーション**: 改善点を反映して再テスト

### テストシナリオの例

```
シナリオ: PDFからテーブルを抽出
入力: test-files/report.pdf
期待動作:
  - 適切なライブラリでPDFを読み込む
  - 全ページからテーブルを抽出する
  - CSVまたはMarkdown形式で出力する
チェック項目:
  - テーブル構造が保持されている
  - ヘッダー行が正しく認識されている
  - 数値データが文字列化されていない
```

### マルチモデルテスト

同じスキルを異なるモデルでテストし、ガイダンスの過不足を確認:

| モデル | テスト観点 | 調整方針 |
|--------|-----------|---------|
| Haiku | テストシナリオで成功するか？ | 失敗する場合、指示を具体化 |
| Sonnet | 効率的に実行できるか？ | 冗長な場合、指示を簡潔化 |
| Opus | 過剰な説明に引きずられないか？ | 当たり前の説明を削除 |

全モデルで一貫した品質を目指す。Haiku向けの詳細化とOpus向けの簡潔化のバランスが重要。
