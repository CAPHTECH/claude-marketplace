# 監査チェックリスト

## 目次

1. [監査の目的](#監査の目的)
2. [抜けやすい領域チェックリスト](#抜けやすい領域チェックリスト)
3. [視点別監査ガイド](#視点別監査ガイド)
4. [監査プロンプト集](#監査プロンプト集)

---

## 監査の目的

生成AIは「それらしい網羅」を"生成"するのは得意だが、「何が未生成か」を"証明"するのは苦手。

**監査の役割**:
- AIを「批判側」に回し、別の視点で抜け漏れを検出する
- 「未知/仮定」が放置されていないか確認する
- 生成物を成果物として提出する前の品質ゲート

---

## 抜けやすい領域チェックリスト

このチェックリストは「生成」ではなく「監査」に使う。

### 例外系・エラー処理

| 観点 | チェック項目 | 抜けやすい理由 |
|------|-------------|---------------|
| **タイムアウト** | 外部IF呼び出しのタイムアウト処理 | 正常系では起きない |
| **部分失敗** | 複数処理のうち一部だけ失敗 | 全成功/全失敗のみ想定しがち |
| **リトライ** | リトライ時の冪等性保証 | リトライ自体を忘れる |
| **キャンセル** | 処理中のキャンセル時の状態 | キャンセルパスを考慮しない |
| **復旧** | エラー後のリカバリーフロー | 正常系優先で後回し |
| **冪等性** | 同一リクエストの2回目の挙動 | 1回の呼び出しのみ想定 |

### 時系列・順序

| 観点 | チェック項目 | 抜けやすい理由 |
|------|-------------|---------------|
| **遅延** | ネットワーク遅延での挙動 | ローカルでは再現しにくい |
| **順序逆転** | 非同期処理の完了順序が想定と異なる | 想定順序のみテスト |
| **二重送信** | ボタン連打、リロード | 単発操作のみ想定 |
| **同時更新** | 複数ユーザーの同時操作 | 排他制御を忘れる |
| **タイミング依存** | 時間経過で変わる挙動 | テスト時点では再現しない |

### 状態依存

| 観点 | チェック項目 | 抜けやすい理由 |
|------|-------------|---------------|
| **初回/再訪** | 初めてのアクセスとリピート | 初回セットアップ忘れ |
| **期限切れ** | セッション/トークン/キャンペーン期限 | 有効期間内のみテスト |
| **権限変更** | 操作中に権限が変わった場合 | 静的な権限を想定 |
| **セッション切断** | 操作中のログアウト/タイムアウト | 接続維持を前提 |
| **状態不整合** | 予期しない状態からの操作 | 正常フローのみ想定 |

### 環境依存

| 観点 | チェック項目 | 抜けやすい理由 |
|------|-------------|---------------|
| **ネットワーク遷移** | オンライン↔オフライン | 常時接続を前提 |
| **バックグラウンド** | アプリがバックグラウンドに移行 | フォアグラウンドのみ想定 |
| **通知** | プッシュ通知の許可/拒否 | 許可状態のみテスト |
| **権限ダイアログ** | カメラ/位置情報等の許可 | 許可済みでテスト |
| **ストレージ不足** | ディスク/メモリ不足 | 十分なリソースでテスト |

### データ・入力

| 観点 | チェック項目 | 抜けやすい理由 |
|------|-------------|---------------|
| **境界値** | 最小/最大/ちょうど境界 | 中央値でテスト |
| **相関制約** | AのときB必須 | 個別項目のみチェック |
| **null/空/未設定** | 値がない場合の挙動 | 値ありでテスト |
| **特殊文字** | 絵文字、制御文字、Unicode | ASCII範囲でテスト |
| **大量データ** | 件数が多い場合 | 少量データでテスト |

### セキュリティ・プライバシー

| 観点 | チェック項目 | 抜けやすい理由 |
|------|-------------|---------------|
| **認可バイパス** | URLを直接叩いてアクセス | 画面遷移経由のみ |
| **ログへのPII混入** | エラーログに個人情報 | 正常系では出ない |
| **入力汚染** | インジェクション攻撃 | 正常入力でテスト |
| **レート制限** | 大量リクエストへの対応 | 単発リクエストでテスト |
| **エラー情報漏洩** | スタックトレースの露出 | 正常系では出ない |

### 運用・監視

| 観点 | チェック項目 | 抜けやすい理由 |
|------|-------------|---------------|
| **監視** | 異常検知のトリガー | 開発時には後回し |
| **アラート** | 通知先と内容 | 本番でないと分からない |
| **ログ** | 必要な情報がログに出るか | 開発時は目視確認 |
| **再現性** | ログから問題を再現できるか | 情報が足りない |
| **障害時の影響範囲** | 部分障害時に他への影響 | 全正常を前提 |

### アクセシビリティ・国際化

| 観点 | チェック項目 | 抜けやすい理由 |
|------|-------------|---------------|
| **読み上げ** | スクリーンリーダー対応 | 視覚確認のみ |
| **フォーカス** | キーボード操作の順序 | マウス操作でテスト |
| **文字サイズ** | 拡大時のレイアウト崩れ | 標準サイズでテスト |
| **RTL** | 右から左の言語対応 | LTRのみでテスト |
| **多言語** | 翻訳の長さ、フォールバック | 日本語のみでテスト |

---

## 視点別監査ガイド

### QA視点（1回目の監査）

一般的な抜け漏れを検出する基本監査。

**重点観点**:
- 要求カバレッジの欠落
- 主要な異常系の漏れ
- 境界値の不足
- 状態遷移の未カバー

### 運用担当視点

本番運用で問題になりそうな観点。

**重点観点**:
- 障害時の挙動（復旧、フェイルオーバー）
- ログの十分性（問題再現に必要な情報）
- 監視・アラートの動作
- バッチ処理の考慮
- バックアップ/リストア

### セキュリティ担当視点

セキュリティリスクの観点。

**重点観点**:
- 認証・認可のバイパス経路
- 入力検証（インジェクション）
- データ保護（暗号化、マスキング）
- セッション管理
- エラー情報の漏洩

### 性能担当視点

性能問題の観点。

**重点観点**:
- 負荷集中時の挙動
- タイムアウト設定の妥当性
- リソース枯渇（メモリ、接続プール）
- キャッシュの有効性
- 大量データ処理

### アクセシビリティ担当視点

アクセシビリティの観点。

**重点観点**:
- キーボード操作の完全性
- スクリーンリーダー対応
- 色のみに依存しない情報伝達
- フォーカス管理
- 拡大表示対応

---

## 監査プロンプト集

### 基本監査プロンプト

```
あなたはテスト監査人（生成した本人ではない体）。
以下のテスト条件ツリーを監査し、抜け漏れの可能性を列挙せよ。

## 監査観点
1. 要求カバレッジ欠落（REQに紐づかない/未対応REQ）
2. 状態遷移の未カバー
3. エラー処理、復旧、冪等性、再試行、タイムアウト
4. 競合（同時操作、二重送信）、順序逆転、遅延
5. 権限/認可、ログ、監査、個人情報
6. 互換性/環境差分
7. テストデータ（境界値、相関制約）
8. "未知/仮定"が放置されてテスト不能になっていないか

## 出力形式
指摘ごとに以下を含めること：
- 観点カテゴリ
- 具体的な抜け漏れ内容
- なぜ抜けやすいか（失敗モード→影響）
- 追加すべきTCNDの提案
```

### 運用視点監査プロンプト

```
あなたは運用担当者の視点でテスト条件を監査する。
本番運用で問題になりそうな観点から抜け漏れを指摘せよ。

## 重点観点
1. 障害発生時の挙動と復旧手順
2. ログの十分性（問題調査に必要な情報）
3. 監視・アラートの動作確認
4. バッチ処理・定期処理の考慮
5. メンテナンス時の挙動

## 出力形式
各指摘に「本番で起きたら何が困るか」を具体的に記述すること。
```

### セキュリティ視点監査プロンプト

```
あなたはセキュリティ担当者の視点でテスト条件を監査する。
セキュリティリスクの観点から抜け漏れを指摘せよ。

## 重点観点
1. 認証・認可のバイパス可能性
2. 入力検証の不足（インジェクション）
3. 機密データの保護（ログ、エラー画面）
4. セッション管理の脆弱性
5. レート制限・DoS対策

## 出力形式
各指摘に「攻撃者がどう悪用できるか」を具体的に記述すること。
```

### 最終確認プロンプト

```
以下の観点で、テスト条件ツリー全体を最終確認せよ。

## 確認項目
1. 全REQにTCNDが紐づいているか？
2. (UNKNOWN)ラベルが残っていないか？
3. 監査で指摘された項目が対応されているか？
4. カバレッジ基準を満たしているか？

## 出力形式
OK/NG判定と、NGの場合は具体的な未対応項目を列挙すること。
```

---

## 監査結果のまとめ方

```markdown
# 監査レポート

## 監査概要

| 項目 | 内容 |
|-----|------|
| 対象 | [テスト条件ツリー バージョン] |
| 監査日 | YYYY-MM-DD |
| 監査視点 | QA視点、セキュリティ視点 |

## 指摘サマリー

| 重要度 | 件数 |
|--------|------|
| Critical | 2 |
| Major | 5 |
| Minor | 8 |

## 指摘詳細

### [Critical] C-001: 二重決済の防止テストなし

- **観点**: 時系列・順序
- **内容**: 決済ボタン連打時の挙動がテストされていない
- **失敗モード→影響**: 二重決済 → 顧客クレーム、返金コスト
- **対応案**: TCND-xxx「同時リクエストでの決済」を追加

### [Major] M-001: セッションタイムアウト後の操作

...

## 対応状況

| ID | 対応 | 担当 | 期限 |
|-----|------|------|------|
| C-001 | TCND-050追加 | - | - |
| M-001 | 検討中 | - | - |
```
