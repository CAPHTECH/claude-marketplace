# Review Criteria

3タイプ × 5重要度の分類体系。各指摘はこのマトリクスで分類する。

## Finding Types

| Type | 意味 | 対応期待 |
|------|------|---------|
| **Bug** | 実行時に誤動作・障害を引き起こす欠陥 | 即座に修正が必要 |
| **Suggestion** | 改善により品質が向上する設計・実装の提案 | 検討の上で対応 |
| **Nitpick** | スタイル・命名・可読性の軽微な指摘 | 任意で対応 |

## Severity Levels

| Severity | 基準 | 例 |
|----------|------|-----|
| **Critical** | データ損失・セキュリティ侵害・システム停止を引き起こす | SQLインジェクション、認証バイパス、デッドロック |
| **Major** | 機能不全・パフォーマンス深刻劣化・本番障害リスク | 未処理例外、N+1クエリ、リソースリーク |
| **Minor** | 限定的影響だが修正すべき | エッジケース未考慮、型安全性の穴、不十分なバリデーション |
| **Trivial** | 品質向上に寄与するが影響は軽微 | 命名改善、コメント追加、コード整理 |
| **Info** | 情報提供・注意喚起のみ | 設計意図の確認、将来的なリスクの指摘 |

## Domain Categories

各指摘は以下のドメインカテゴリに分類する。

### Security
- インジェクション（SQL/XSS/Command/Path Traversal）
- 認証・認可の欠陥
- 秘密情報の露出（ハードコード秘密鍵、ログへの機密出力）
- 暗号の誤用（弱いアルゴリズム、固定IV/Salt）
- CSRF/SSRF/IDOR

### Data Integrity
- トランザクション整合性（部分コミット、ロールバック漏れ）
- レースコンディション・TOCTOU
- データバリデーション不備（境界値、型変換）
- 冪等性の欠如

### Reliability
- 未処理例外・パニック
- リソースリーク（ファイルハンドル、DB接続、goroutine）
- 無限ループ・再帰の終了条件不備
- タイムアウト・リトライ設計の欠如
- エラーの握り潰し

### Type Safety
- プリミティブ型の濫用（Primitive Obsession）
- 不正な状態を表現可能な型設計
- 暗黙の型変換・any/unknown の不適切な使用
- null/undefined の安全でない参照

### Design
- SOLID原則違反
- 高結合・低凝集
- ドメインモデルの不整合
- 責務の混在
- 抽象化レベルの不一致

### Performance
- N+1 クエリ
- 不要な計算・メモリ確保
- キャッシュ機会の見逃し
- 非効率なアルゴリズム（O(n²) → O(n) 可能な箇所）
- バンドルサイズ肥大化

### Maintainability
- コード重複（DRY違反）
- テスト困難な設計
- 暗黙の前提・マジックナンバー
- 過度な複雑性（循環的複雑度高）
- ドキュメント不備（公開APIの未文書化）

### UI/UX
- 無効な状態の組み合わせ（loading + error 同時表示等）
- アクセシビリティ不備（ARIA、キーボードナビ、色依存）
- レスポンシブ設計の問題
- 不要な再レンダリング
- Props drilling / コンポーネント責務過多

## Output Slot Allocation

最大7件。静的解析結果は別枠。

| 優先度 | Slot数 | 対象 | 備考 |
|--------|--------|------|------|
| 1 | 最大2 | Bug/Critical, Bug/Major | 常に最優先で報告 |
| 2 | 最大2 | Suggestion/Critical, Suggestion/Major, Bug/Minor | Bug > Suggestion の順 |
| 3 | 最大2 | その他 Suggestion/Minor, Bug/Trivial | 影響の大きい順 |
| 4 | 最大1 | Nitpick (任意のSeverity) | 最も有益なもの1件 |

Critical が多い場合は上限を超えて報告する（Critical を切り捨ててはならない）。
Info は件数枠を消費しない（付記として記載）。
Nitpick のみの場合はSlot数を減らす。

## Confidence Labels

各指摘には検証フェーズの結果として確信度ラベルを付与する。

| Label | 意味 | 基準 |
|-------|------|------|
| **Verified** | ツール/grepで確認済み | 該当コードの存在、パターンの一致をツールで検証 |
| **Likely** | 高い確度で問題あり | コンテキストから判断、ただし完全な検証は未実施 |
| **Possible** | 問題の可能性あり | 状況証拠のみ、追加調査推奨 |
