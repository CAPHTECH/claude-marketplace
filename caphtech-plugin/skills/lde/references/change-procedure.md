# Law変更手順

## 変更フロー

```
Law変更 → 影響範囲分析 → 互換性判断 → 段階リリース
```

## 1. Law変更の識別

Law変更は単なる「実装変更」ではなく「仕様変更」として扱う。

### 変更のトリガー

- ビジネス要件の変更
- 障害対応からの改善
- 監査・コンプライアンス要件
- パフォーマンス要件の変更

## 2. 影響範囲分析

### 確認項目

| 項目 | 確認内容 |
|------|----------|
| Scope | 影響を受けるモジュール・エンドポイント |
| 依存 | このLawに依存する他のLaw |
| データ | 既存データへの影響 |
| API | 入出力の互換性 |

### Impact Graph

- Lawの依存関係をグラフで可視化
- 変更時に影響候補を自動列挙
- 「推論」ではなく「候補列挙」に限定

## 3. 互換性判断

### 互換性レベル

| レベル | 説明 | 対応 |
|--------|------|------|
| 後方互換 | 既存の入力が同じ結果を返す | 通常リリース |
| 前方互換 | 新しい入力を古い実装が処理可能 | バージョニング |
| 非互換 | 既存の振る舞いが変わる | 移行計画必須 |

### 非互換変更の扱い

1. 移行期間を設定
2. 旧Lawと新Lawの並行運用
3. 監視強化期間
4. 旧Law廃止

## 4. 段階リリース

### リリース戦略

| 戦略 | 用途 |
|------|------|
| カナリア | 一部ユーザーで検証 |
| ブルーグリーン | 即座にロールバック可能 |
| フィーチャーフラグ | 動的に切り替え可能 |

### ロールバック基準

- 違反率が閾値を超えた
- パフォーマンス劣化
- 障害発生

## 5. レビューチェックリスト

- [ ] Law変更としてレビューされている（単なる実装変更になっていない）
- [ ] 影響範囲（Scope/依存）が列挙されている
- [ ] 互換性（入力/出力/データ）が評価されている
- [ ] 段階リリース計画がある
- [ ] ロールバック手順がある
- [ ] 監視強化計画がある
