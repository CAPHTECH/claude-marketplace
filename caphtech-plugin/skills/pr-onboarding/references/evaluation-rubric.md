# PRオンボーディング評価ルーブリック

PRオンボーディングの品質を評価する基準。運用に耐える"採点軸"として使用する。

---

## 評価軸

| 軸 | 内容 | 重要度 |
|----|------|--------|
| 明確性 | What/Why/影響が短く明確か | 高 |
| 反証可能性 | 不変条件・検証・根拠リンクがあるか | 高 |
| 運用可能性 | 壊れ方＋検知＋ロールバックが揃っているか | 高 |
| 追跡可能性 | DocDDの正本・設計ID・代表フロー/境界IDに接続しているか | 中 |
| 誠実性 | 不確実性を隠していないか（Unknownsが適切か） | 高 |

---

## 詳細評価基準

### 1. 明確性（Clarity）

**評価観点**: What/Why/影響が短く明確か

| レベル | 基準 |
|--------|------|
| 5 (Excellent) | 1画面で全体像が把握でき、詳細はリンクで補完 |
| 4 (Good) | 主要な変更点と理由が明確、一部冗長 |
| 3 (Acceptable) | 変更点は分かるが、理由が曖昧または長すぎる |
| 2 (Poor) | 何が変わったかは分かるが、なぜかが不明 |
| 1 (Unacceptable) | 何が変わったかすら不明確 |

**チェックリスト**:
- [ ] Summaryが3行以内
- [ ] What/Whyが分離されている
- [ ] 専門用語に説明または参照がある
- [ ] 1〜2画面に収まっている

---

### 2. 反証可能性（Falsifiability）

**評価観点**: 不変条件・検証・根拠リンクがあるか

| レベル | 基準 |
|--------|------|
| 5 (Excellent) | 全ての主張に根拠リンク、不変条件が明文化、検証方法が再現可能 |
| 4 (Good) | 主要な主張に根拠あり、不変条件が定義されている |
| 3 (Acceptable) | 一部の主張に根拠あり、不変条件が部分的 |
| 2 (Poor) | 根拠がほとんどなく、主張のみ |
| 1 (Unacceptable) | 根拠なしの断言のみ |

**チェックリスト**:
- [ ] 不変条件が最低1つ定義されている
- [ ] 不変条件に「破ったときの症状」がある
- [ ] Evidenceにテスト結果/CIリンクがある
- [ ] コード参照にファイルパスと行番号がある

---

### 3. 運用可能性（Operability）

**評価観点**: 壊れ方＋検知＋ロールバックが揃っているか

| レベル | 基準 |
|--------|------|
| 5 (Excellent) | 壊れ方3種＋具体的検知手段＋ロールバック手順が完備 |
| 4 (Good) | 壊れ方と検知手段あり、ロールバック手順が明確 |
| 3 (Acceptable) | 壊れ方の言及あり、検知手段が曖昧 |
| 2 (Poor) | 壊れ方の言及なし、ロールバック手順が不明確 |
| 1 (Unacceptable) | 運用観点の記述なし |

**チェックリスト**:
- [ ] Failure Modesに3種類（起きやすい/致命的/気づきにくい）がある
- [ ] 各壊れ方に検知手段（テスト名/ログキー/メトリクス）がある
- [ ] Rollback手順が具体的
- [ ] ロールバック不能条件があれば明記

---

### 4. 追跡可能性（Traceability）

**評価観点**: DocDDの正本・設計ID・代表フロー/境界IDに接続しているか

| レベル | 基準 |
|--------|------|
| 5 (Excellent) | 関連Issue/ADR/ドキュメント全てにリンク、更新提案あり |
| 4 (Good) | 主要な関連ドキュメントにリンクあり |
| 3 (Acceptable) | Issueへのリンクあり、ドキュメントは一部 |
| 2 (Poor) | 関連リンクがほとんどない |
| 1 (Unacceptable) | 外部参照なし |

**チェックリスト**:
- [ ] 関連Issueへのリンクがある
- [ ] 設計ドキュメント/ADRへの参照がある（該当する場合）
- [ ] 更新が必要なドキュメントが指摘されている
- [ ] コード内の関連箇所へのリンクがある

---

### 5. 誠実性（Honesty）

**評価観点**: 不確実性を隠していないか（Unknownsが適切か）

| レベル | 基準 |
|--------|------|
| 5 (Excellent) | 不確実性が構造化され、解消手段とブロッカー判定あり |
| 4 (Good) | 不確実性が明示され、解消手段がある |
| 3 (Acceptable) | 不確実性の言及あり、解消手段が曖昧 |
| 2 (Poor) | 不確実性がほとんど言及されていない |
| 1 (Unacceptable) | 全て確定しているかのように書かれている |

**チェックリスト**:
- [ ] Unknownsセクションがある
- [ ] 各Unknownに解消手段がある
- [ ] マージブロッカーかどうかが明記されている
- [ ] 「問題ないはず」等の楽観表現がない

---

## 総合評価

### スコア計算

```
総合スコア = (明確性 + 反証可能性 + 運用可能性 + 追跡可能性 + 誠実性) / 5
```

### 合格基準

| スコア | 判定 | アクション |
|--------|------|-----------|
| 4.0以上 | Excellent | マージ可能 |
| 3.0-3.9 | Good | 軽微な修正後マージ可能 |
| 2.0-2.9 | Needs Work | 修正必須、再レビュー |
| 2.0未満 | Unacceptable | 大幅な書き直しが必要 |

---

## クイックチェックリスト

PRオンボーディングの最終確認用:

### 必須（これがないとマージ不可）
- [ ] Summary: 何が変わったか1〜3文で
- [ ] Why: なぜ変えたか、代替案は検討したか
- [ ] Invariants: 壊してはいけないこと最低1つ
- [ ] Evidence: 検証の証拠（テスト結果/CI）
- [ ] Unknowns: 不確実なことリスト

### 推奨（あるとレビューが速い）
- [ ] Blast Radius: 影響範囲
- [ ] Failure Modes: 壊れ方と検知手段
- [ ] Rollback: 戻し方
- [ ] Review Focus: レビューの重点
- [ ] Related: 関連Issue/Doc

### 禁止（これがあると不合格）
- [ ] 実行していないテストを「実行した」と書いていない
- [ ] 「問題ないはず」等の楽観表現がない
- [ ] Unknownsが意図的に空にされていない
- [ ] 影響範囲が過小評価されていない

---

## 評価の運用

### いつ評価するか

1. **PR作成時**: 作成者がセルフチェック
2. **レビュー時**: レビューアが品質確認
3. **振り返り時**: チームで改善点を議論

### 誰が評価するか

- **作成者**: セルフチェック（必須）
- **レビューア**: 品質確認（必須）
- **チーム**: 定期的なサンプルレビュー（推奨）

### 評価結果の活用

1. **低スコアの傾向分析**: どの軸が弱いか
2. **テンプレート改善**: 足りない項目を追加
3. **トレーニング**: よくある問題の共有
